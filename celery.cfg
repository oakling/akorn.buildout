[buildout]

parts =
    celery
    rabbitmq
    supervisor

extends =
    base.cfg
    versions.cfg

extensions =
    mr.developer

eggs =
    Django
    BeautifulSoup
    feedparser
    lxml
    couchdb
    celery
    amqplib
    fabric
    pysqlite
    akorn_search
    akorn.celery
    akorn.scrapers
    ipython
    requests<1.2.3
    django_assets
    django-extensions
    python-spidermonkey
    mock
    readline
    cssmin
    cssselect
    pylibmc

auto-checkout =
    akorn_search
    akorn.celery
    akorn.scrapers
    collective.recipe.couchdblucene

show-picked-versions = true
versions = versions

[ports]
http = 8000
uwsgi = 9000

[hosts]
localhost = 127.0.0.1

[celery]
recipe = collective.recipe.celery
broker-transport = amqplib
broker-host = 127.0.0.1
broker-vhost = myvhost
broker-user = akorn
broker-password = akorn
eggs = ${buildout:eggs}

[rabbitmq]
recipe = rod.recipe.rabbitmq
url = http://www.rabbitmq.com/releases/rabbitmq-server/v3.0.4/rabbitmq-server-3.0.4.tar.gz

[supervisor]
recipe = collective.recipe.supervisor
programs =
    10 celery ${buildout:bin-directory}/celeryd
    20 rabbit ${buildout:bin-directory}/rabbitmq-server
    30 couchdb ${couchdb:location}/bin/couchdb
    40 couchdb-lucene ${couchdb-lucene:target}/bin/run
    50 memcached ${memcached:location}/bin/memcached [-m 64]
    60 nginx ${nginx:location}/sbin/nginx [-c ${nginx:location}/conf/nginx.conf]
    70 uwsgi ${buildout:bin-directory}/uwsgi [--xml ${buildout:directory}/parts/uwsgi/uwsgi.xml]
