[buildout]

parts =
    django
    omelette
    console_scripts
    rubygems
    uwsgi
    nginx
    nginx-config
    supervisor

extends = versions.cfg

extensions =
    mr.developer

eggs =
    Django
    couchdb
    fabric
    pysqlite
    akorn_search
    akorn.scrapers
    ipython
    requests<1.2.3
    django_assets
    django-extensions
    mock
    cssmin
    lxml
    cssselect
    feedparser

auto-checkout =
    akorn_search
    akorn.scrapers

show-picked-versions = true
versions = versions

[rubygems]
recipe = rubygemsrecipe
gems = sass

[ports]
http = 80
uwsgi = 9005

[hosts]
localhost = 127.0.0.1

[uwsgi]
recipe = buildout.recipe.uwsgi
xml-master = True
xml-processes = 3
xml-socket = ${hosts:localhost}:${ports:uwsgi}
xml-wsgi-file = ${buildout:bin-directory}/django.wsgi

[nginx]
recipe = hexagonit.recipe.cmmi
url = http://nginx.org/download/nginx-1.5.3.tar.gz

[nginx-config]
recipe = collective.recipe.template
input = ${buildout:directory}/templates/nginx/conf/nginx.conf
output = ${nginx:location}/conf/nginx.conf
http_port = ${ports:http}
server_name = akorn.org
uwsgi_host = ${hosts:localhost}
uwsgi_port = ${ports:uwsgi}

[django]
recipe = djangorecipe
projectegg = akorn_search
settings = settings
eggs = ${buildout:eggs}
extra-paths =
    ${buildout:directory}/src
    ${buildout:directory}/src/akorn_search
    ${buildout:directory}/src/akorn_search/akorn_search
test = akorn_search
wsgi = true

[omelette]
recipe = collective.recipe.omelette
eggs = ${buildout:eggs}

[console_scripts]
recipe = zc.recipe.egg
eggs = ${buildout:eggs}
scripts = ipython

[supervisor]
recipe = collective.recipe.supervisor
programs =
    10 uwsgi ${buildout:bin-directory}/uwsgi [--xml ${buildout:directory}/parts/uwsgi/uwsgi.xml]

[sources]
akorn_search = git https://github.com/oakling/Oakling.git
akorn.scrapers = git https://github.com/oakling/akorn.scrapers.git
